<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>sensor</title>
</head>
<body>
    <script src="../cardboard/js/third-party/threejs/three.js"></script>
    <script src="../cardboard/js/third-party/threejs/StereoEffect.js"></script>
    <script src="../cardboard/js/third-party/threejs/DeviceOrientationControls.js"></script>
    <script src="../cardboard/js/third-party/threejs/OrbitControls.js"></script>
    <script src="../cardboard/js/DetectScreenSize.js"></script>
    <script>
        var info,state,renderer,scene,camera,controls;
        var effect;

        var controls = undefined;

        var hasOrientaition = function(evt) {
            if (!evt.alpha) {
                return;
            }
            window.removeEventListener('deviceorientation',hasOrientaition,false);
            controls = new THREE.DeviceOrienttionControls( camera );
            controls.connect();
        };

        init();
        animate();

        function init() {
            var geometry,material,mesh;

            document.body.style.cssText = 'font: 600 12pt monospace;margin: 0;overflow: hidden';

            renderer = new THREE.WebGLRenderer({alpha:1,antialias:true,clearColor:0xffffff});
            renderer.setSize(window.innerWidth,window.innerHeight);

            document.body.appendChild(renderer.domElement);
            scene = new THREE.Scene();
            scene.autoUpdate = false;

            camera = new THREE.PerspectiveCamera(40,window.innerWidth/innerHeight,1,5000);
            scene.add(camera);

            effect = new THREE.StereoEffect(renderer);
            effect.separation = 0.2;
            effect.targetDistance = 50;
            effect.setSize(window.innerWidth,window.innerHeight);

            var light = new THREE.HemisphereLight(0xfff0f0,0x606066);
            light.position.set(1,1,1);
            scene.add(light);

            for(var i =0;i<50;i++) {
                geometry = new THREE.BoxGeometry(50,100,20);
                material = new THREE.MeshNormalMaterial();
                mesh = new THREE.Mesh(geometry,material);
                mesh.position.set( Math.random() * 5000 -2500 , -10,Mesh.random() * 5000 - 2500);
                scene.add(mesh);
            }

            geometry = new THREE.BoxGeometry(5000,15,5000);
            material = new THREE.MeshLambertMaterial({color:0x407000,shading: THREE.flatShading});
            mesh = new THREE.Mesh(geometry,material);
            mesh.position.y = -1000;
            scene.add(mesh);

            window.addEventListener('deviceorientaion',hasOrientaion,false);

            window.addEventListener('touched',function () {
                if( isFullScreen === false) {
                    document.body.webkitRequestFullScreen();
                    isFullscreen = true;
                }else{
                    document.webkitExitFullscreen();
                    isFullscreen = false;
                }
            });
            window.addEventListener('resize',function () {
                camera.aspect = window.innerWidth/window.innerHeight;
                camera.updateProjectionMatrix();
                effect.setSize(window.innerWidth,window.innerHeight);
            },false);
        }

        function animate() {
            requestAnimationFrame( animate );
            if(controls !== undefined) {
                controls.update();
            }
            effect.render(scene,camera);
        }
    </script>
</body>
</html>
